{# ===== ذروة - عروض الفلاش ===== #}
{# يعرض المنتجات المخفضة مع عداد تنازلي #}

<section class="therwa-flash py-12" style="background-color: var(--color-primary);">
    <div class="container">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6 mb-8">
            <div>
                <h2 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-3">
                    <span>⚡</span> عروض الفلاش الحصرية
                </h2>
                <p class="text-white/70 mt-2">لا تفوت هذه العروض المحدودة!</p>
            </div>
            <div class="flex items-center gap-2">
                <span class="text-white/80 text-sm">ينتهي خلال:</span>
                <div class="flex gap-2" id="flash-timer">
                    <div class="bg-white/20 px-3 py-2 rounded-lg text-center min-w-[50px]">
                        <span class="block text-xl font-bold text-white" id="t-days">00</span>
                        <span class="text-xs text-white/70">يوم</span>
                    </div>
                    <div class="bg-white/20 px-3 py-2 rounded-lg text-center min-w-[50px]">
                        <span class="block text-xl font-bold text-white" id="t-hours">00</span>
                        <span class="text-xs text-white/70">ساعة</span>
                    </div>
                    <div class="bg-white/20 px-3 py-2 rounded-lg text-center min-w-[50px]">
                        <span class="block text-xl font-bold text-white" id="t-mins">00</span>
                        <span class="text-xs text-white/70">دقيقة</span>
                    </div>
                    <div class="bg-white/20 px-3 py-2 rounded-lg text-center min-w-[50px]">
                        <span class="block text-xl font-bold text-white" id="t-secs">00</span>
                        <span class="text-xs text-white/70">ثانية</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {% for product in products %}
                {% if product.sale_price %}
                <div class="bg-white rounded-2xl overflow-hidden shadow-lg">
                    <salla-product-card
                        product-id="{{ product.id }}"
                        product='{{ product | json_encode }}'
                        shadowOnHover
                        show-quantity
                    ></salla-product-card>
                </div>
                {% endif %}
            {% endfor %}
        </div>
        
        <div class="text-center mt-8">
            <a href="/products?on_sale=1" class="inline-flex items-center gap-2 px-8 py-3 bg-white rounded-lg font-bold hover:bg-gray-100 transition" style="color: var(--color-primary);">
                عرض جميع العروض
                <i class="sicon-keyboard-arrow-left"></i>
            </a>
        </div>
    </div>
</section>

<script>
(function(){
    var end = new Date();
    end.setDate(end.getDate() + 3);
    function update() {
        var now = new Date().getTime();
        var diff = end - now;
        if (diff > 0) {
            document.getElementById('t-days').textContent = Math.floor(diff / 86400000).toString().padStart(2, '0');
            document.getElementById('t-hours').textContent = Math.floor((diff % 86400000) / 3600000).toString().padStart(2, '0');
            document.getElementById('t-mins').textContent = Math.floor((diff % 3600000) / 60000).toString().padStart(2, '0');
            document.getElementById('t-secs').textContent = Math.floor((diff % 60000) / 1000).toString().padStart(2, '0');
        }
    }
    update();
    setInterval(update, 1000);
})();
</script>
